Maximus5 - 2009.07.xx

[%] Лечим артефакты отрисовки (ClearType).
[%] Force monospace. Ширина шрифта не передергивалась при изменении флажка 'Force monospace'.
[%] Немного поправлен алгоритм определения 'темности' фона при отрисовке курсора.


Maximus5 - 2009.07.11

%) Падение ConEmu при выполнении длинных команд, содержащих амперсанды (&).
%) Исправлена отрисовка курсора на прокрутке и прогрессе в третьем состоянии флажка 'Fix far borders'.
%) При возникновении ошибки 'The requested operation requires elevation' программа запускается немодально в новой консоли, не подключенной к ConEmu.
*) По окончанию загрузки в консоли FAR (точнее, при загрузке плагина ConEmu) отключается требование 'Press Enter to close console...'.
*) Manifest.
*) Изменен алгоритм цвета курсора. При отключенном флажке 'Color' курсор белый (точнее color#15) на темном фоне и черный (color#0) на светлом фоне. При включенном флажке 'Color' курсор отрисовывается как в стандартной консоли.


Maximus5 - 2009.07.09

%) Проблемы при закрытии консолей, после открытия максимального их количества (12).
%) Поправлена активация с клавиатуры Win-F11/F12.
%) При закрытии/пересоздании консоли пропадал таб этой консоли.
%) В некоторых случаях не работало ограничение FPS.
%) Небольшие правки ресайза (Tabs, Alt-F9).
*) При невозможности создать новую консоль (их уже максимальное количество) отображается предупреждение.
*) Переменные окружения. 'ConEmuHWND' удаляется (плагином) при детаче консоли или аварийном завершении графической части. Добавлена переменная 'ConEmuDir'.
*) Возвращен 'cmd_autorun.cmd'. 'Прицепить' к GUI любую консоль можно выполнив в ней команду 'conemuc /ATTACH /NOCMD'.
+) В меню плагина добавлен пункт 'Attach to ConEmu'. Для тех случаев, когда был детач (CtrlAltTab) или FAR был запущен отдельно.


Maximus5 - 2009.07.07

%) После запуска и закрытия 16битного приложения замедлялась реакция на изменения в консоли.
%) Неправильно обрабатывалась высота консоли в 16битном режиме. Сейчас поддерживаются все стандартные высоты (25,28,43,50). Перед запуском 16битного приложения может быть принудительно установлена высота, задаваемая в настройке ("16bit Height").
*) Правки в GCC мейке.
+) Разрешена смена размера консоли самим консольным приложением (например, командой 'MODE CON: COLS=80 LINES=25').


Maximus5 - 2009.07.05

!) Эта версия полностью собрана в gcc.
%) Правки для 16битных приложений. 'Интеллектуальное' закрытие консоли. При выходе из 16бит приложения размер окна ConEmu схлопывался до 80x28.
%) Плагин не учитывал, что FAR мог быть запущен с ключом /u.
%) Исправлены проблемы ресайза при отображении/скрытии табов.
%) Win-0 ошибочно активировала 11-ю консоль, а Win-F11/F12 вообще не работали.
*) Ошибка 'ConEmu received old version packet...' отображается один раз за сеанс.
*) При ошибке запуска корневого процесса (far.exe/cmd.exe/etc.) отображается расширенная информация об ошибке.
*) При активации окна мышкой щелчок в консоль не пересылается (больше нет опасности случайно закрыть открытый диалог), а двойной щелчок (при активации) заменяется на одинарный. Флажок 'Skip activation' на вкладке 'Features'.
*) Если окно ConEmu неактивно - в консоль не посылаются события движения мыши. Флажок 'Skip moving' на вкладке 'Features'.
*) На 'Info' в заголовке группы 'Performance counters' вроде должна отображаться частота процессора.
+) На вкладке Features добавлены настройки мультиконсоли.


Maximus5 - 2009.07.01

%) В некоторых случаях (задержка запуска антивирусом) ConEmu закрывался сразу после запуска консольной программы.
%) При запуске GUI приложений их окна могли появляться под окном ConEmu. Пример: открытие папок в проводнике (ShiftEnter), диалог выбора Topic (плагин MSDN).
%) Правки в GCC мейке, убраны GCC ворнинги.
%) Консоль не отрисовывалась во время работы 16-битных приложений.
*) Расширено окно настроек.
*) В полосе прокрутки (режим буфера) вернулась поддержка тем Windows XP.
+) Перехватывается мигание (скрытой) реальной консоли (FlashWindow). Вместо нее мигает ConEmu. Если окно ConEmu неактивно - мигание продолжается до активации окна. Если ConEmu активно и мигает неактивная консоль - ConEmu мигает несколько раз.
+) К иконке Windows7 прикручен прогресс (по содержимому заголовка консоли, то есть как для фара, так и для плагинов).


Maximus5 - 2009.06.28

%) Правки в GCC мейке.
%) Кнопки тулбара иногда помещались перед табами при сужении окна. 
%) Изменения в 'Window size' (окно настроек) не применялись при нажатии 'Save settings'.
%) Выпадающие списки размеров шрифта отображали некорректную информацию, если в списке не было текущего значения.
%) Не обрабатывался прогресс плагина FTP (пример: {13.1%}).
%) При изменении размеров учитывается максимально допустимый размер консоли (для выбранного шрифта в real console).
*) PictureView автоматически скрываются/отображаются при переключении между консолями. Переключения на другие табы консоли с активным PictureView заблокировано.
*) В окне настроек изменения шрифта применяются только при потере фокуса изменяемого поля ввода (пока Tab не нажмешь - не изменяется), или при выборе значения из списка.
*) При сужении кнопки тулбара автоматически скрываются.


Maximus5 - 2009.06.27

%) После 06.18 поломалось выделение мышкой в граббере. Исправлено.
%) Табы не реагировали на изменения в редакторе во время макросов.
%) Звездочка (признак изменений редактора в табе) не появлялась после первого нажатия клавиши (и не сразу исчезала после сохранения).
%) Уточнения в ConEmuC запуска команд.
%) При быстром вводе текста могли теряться некоторые нажатия.
%) Не работал ввод символа через Alt-цифры при включенном NumLock.
+) При создании новой консоли (Win-W) или пересоздании активной (Win-~) в открывающемся диалоге подтверждения пользователь может изменить запускаемую команду (например ввести 'cmd.exe').
+) Если в активной консоли в заголовке не отображаются проценты (copy/move/...), но проценты есть в заголовках неактивных консолей, то в начале заголовка ConEmu отображается максимальное значение процентов неактивных консолей.
+) При быстром драге правой кнопкой мышки выделение файлов (папок) в панелях получалось рваным (windows не посылал мышиные события для некоторых участков). "RSelectionFix"=hex:01 (включено по умолчанию) исправляет этот недостаток, досылая необходимое количество событий в FAR.
*) В reg-файле ключ "Experimental" переименован в "FixFarBorders". При отсутствии нового имени значение будет считано из старого.
*) Изменен диапазон символов, на которые влияет "FixFarBorders". До 10 диапазонов можно указать в значении "FixFarBordersRanges".
*) Если 'корневая' программа (far, cmd, ...) проработала менее 10 секунд, то перед закрытием консоли отображается 'Press Enter to close console...'. Смысл в том, чтобы видеть ошибки запуска программы, ошибки в аргументах и т.п., если таковые были.
*) Возможность просмотра 'длинного вывода' консольной программы возможна в любом фаре консоли (например FAR 1.7x запущен из FAR 2.0).


Maximus5 - 2009.06.24

%) Правки в отрисовке.
%) Некорректно передавался список процессов, что в некоторых случаях приводило к закрытию ConEmu сразу после запуска.
%) Исправлена проблема с непопаданием фокуса ввода в контекстное меню.
*) Немного добавим красивости в таб и тулбар.


Maximus5 - 2009.06.23

%) Исправлена ошибка запуска программ, если путь к ConEmuC содержал пробел (Program Files).
%) CtrlShiftTab приводил к зависанию (в режиме "TabRecent"=hex:01).
%) Правки в отрисовке.
*) Возможность просмотра 'длинного вывода' консольной программы возможна только в первом фаре консоли. То есть если запустить фар из фара в той же консоли - длинный вывод программы, запущенной из второго фара уже не посмотришь.
*) Для удобства использования режима ("TabRecent"=hex:01) после нажатия Ctrl(Shift)Tab и удерживаемом Ctrl переключаться по вкладкам в обычном режиме можно клавишами-стрелками.
+) Вернулась возможность пользоваться плагином Update.


Maximus5 - 2009.06.22

%) Правки в отрисовке и синхронизации.
+) Переключение по табам (консолям/редакторам/вьюверам) с клавиатуры теперь соответствует истории их активации (a'la Opera & Visual Studio). Вернуть стандартное поведение можно через параметр настройки "TabRecent".


Maximus5 - 2009.06.20

%) Курсор опять мигает.
%) Немного полечил отрисовку.
*) Изменен способ уменьшения FPS при выполнении консольных команд/утилит (dir/s и пр).
+) Мигание курсора можно отключить (флажок 'Blinking' в диалоге настроек).
*) Косметика в 'Background image'. В 3-м состоянии флажка фоновый рисунок отображается только в панелях. При включении флажка проверяется значение 'Darkening' и выдается предупреждение, если там 0.
*) Косметика в диалоге настроек. Ctrl-(Shift)-Tab переключаются по вкладкам.
+) В меню плагина добавлены команды для работы с табами (показать/спрятать, переключиться, активировать выделенный).
+) Добавлен макрос CtrlShiftT.reg - показать/спрятать табы.
*) KIS при запуске консольных программ гундел "... пытается послать оконное сообщение".
*) Если для реальной консоли в реестре задан шрифт, ConEmuC проверяет его наличие. При отсутствии шрифта выбирается 'Lucida Console'.
*) Косметика диалога настроек. Уменьшена задержка открытия окна. Tooltips для ComboBox'ов.


Maximus5 - 2009.06.19

!) Макросы (reg-файлы) перемещены в папку 'ConEmu.Addons'.
+) В командной строке ConEmu.exe можно указать ключик '/single'. В этом случае команда выполнится в новой консоли ранее запущенного приложения. Если ни одного ConEmu еще не запущено - выполнение идет в обычном режиме.
+) В 'ConEmu.Addons' добавлены FarHereInstall.cmd (FarHereUninstall.cmd), добавляющий (убирающий) пункт 'Far here' в контекстное меню проводника Windows. Если ConEmu не был запущен - запускается, иначе - открывается вкладка.
*) Поправлена обработка 'RightClick for context menu'. При желании можно вместо отсылки в консоль кнопки 'Apps' явно указать макрос, вызывающий меню (см. параметр "RightClickMacro" в Settings-ConEmu.reg).
!) Изменения в отрисовке. Вся графика обрабатывается только в главной нити.


Maximus5 - 2009.06.18

%) Двойной щелчок по слову в редакторе FAR (в некоторых случаях) ставил, но сразу снимал выделение. Лечим глюк microsoft'а.
%) Правый щелчок по вкладке выполняет (после ее активации) настраиваемый макрос (по умолчанию "F10").
%) Валился D&D с панели на панель.
*) Немного изменено общение с плагином. Зависаний при невозможности выполнить команду (переключение таба, например) больше быть не должно.
*) Немного ускорен запуск drag&drop.


Maximus5 - 2009.06.17

%) Плагин падал в FAR 2 build 995+.
%) Попытка недопустить зашкаливания FPS при выполнении команд типа 'dir /s'. Слишком частое обновление экрана приводило к 100% загрузке процессора. Теперь FPS в буферном режиме принудительно занижается.
%) Лечим отрисовку (белый прямоугольник при запуске, черные полосы при ресайзе).
%) Вернул автопоказ/скрытие табов. Теперь это работает и для создания/закрытия новой консоли.
*) В окошке 'Settings' на вкладке 'Info' добавлен счетчик FPS.


Maximus5 - 2009.06.16

+) Веса (для вычисления цвета) символов прогрессов и прокруток можно задать в реестре - PartBrushXX ('Fix Far borders' in 3-d state).
+) При дампе консоли рядом с файлом '.con' создается файл '.bmp'.
+) Весь проект теперь можно собрать в GCC.
+) Макрос 'ShiftEnter.reg' для запуска ком.строки или файла под курсором в новой вкладке ConEmu.
%) Табы плохо переключались с клавиатуры, если в одном из них менялся заголовок (прогресс копирование, и т.п.).


Maximus5 - 2009.06.14

+) Если табы скрыты и открыто больше одной консоли - в заголовке окна отображается '[консоль/всего] ...'.
%) Табы, если 'Always show menu bar'. Не переключались вообще. ConEmu падал по правому щелчку.
%) Если табы были скрыты - Ctrl-Tab не переключался между консолями.
%) В закладках не отображались '&'.
*) Добавлены тултипы в диалоге настройки для группы 'Font'.
*) При включенном 'Fix Far borders' рамки рисуются всегда без anti-aliasing.
*) Изменена логика применения изменений шрифта в диалоге настройки. Старые глюки убраны, могли появиться новые :)
*) Флажок 'Fix Far borders' теперь имеет третье состояние. В этом случае ConEmu самостоятельно отрисовывает символы прогрессов и прокруток.
*) Шрифт, переданный параметром /fontfile пытается регистриться и для консоли.


Maximus5 - 2009.06.13

+) Возможность задавать шрифт для реальной консоли (см. reg-файл).
%) Некорректно отображались табы при запуске 'far /e ...' или 'far /v ...'.
%) В сборке 2009.06.12 часть консоли могла отображатся некорректным шрифтом.
%) Продолжаем бороться с неотрисовкой.


Maximus5 - 2009.06.12

%) Пункт меню 'Paste' подвисал.
%) Изменен способ отрисовки курсора (не путать с выделением в панелях). Двух курсоров на экране больше не будет.
*) Мультиконсоль по умолчанию (в новых конфигурациях) включена.
*) При запуске ConEmu основное окно могло отрисовываться с задержкой (пока не запустился консольный процесс).


Maximus5 - 2009.06.11

+) В меню окна ConEmu добавлен пункт 'Paste'.
%) Не совсем починился фокус, при щелчке средней кнопкой по табу.
%) Чиним ресайз.
%) После Alt-F9, Alt-F9 некорректно открывалась картинка в PictureView.


Maximus5 - 2009.06.09

+) Добавлена обработка параметра -new_console. Пример:
   dir -new_console c:\windows\*.*
   запустится в новой вкладке ConEmu.
   ! Вкладка автоматически не закрывается 
   ! закрытие только после завершения выполненной команды и нажатия Enter.
*) Форматирование заголовка 'панельной' вкладки (изменено имя параметра реестра на "TabConsole").
+) В диалоге подтверждения перезапуска консоли (Win+~) кнопка 'Yes' - перезапуск, кнопка 'No' - закрытие, 'Cancel' - отказ.
%) Поправлена обработка аргументов в ConEmuC.
%) Продолжаем лечить непрорисовку.
%) Не активировалась вкладка (Ctrl-Tab) если из фара было запущено другое консольное приложение.


Maximus5 - 2009.06.08

* Значительные изменения. Консольный код вынесен в отдельный процесс. В результате многие ошибки/проблемы исчезли, но могли появиться новые.
+) Запуск нового процесса через ConEmuC.exe
+) Поддержка 'мультиконсоли' более не требует ConMan.exe, ConMan.dll или хуков. Управление стандартное (через тулбар или Win-Q/W/1..0/F11/F12). Кнопки создания/смены консоли можно переопределить в реестре. При создании новой консоли через шортках выдается подтверждение (отключаемо).
+) Полностью исключено мелькание черного консольного окна при запуске.
+) События от клавиатуры и мыши помещаются в буфер консоли напрямую, возможно это устанит 'торможение' реакции на клавиши.
+) Корректное завершение процесса по крестику.
?) Режим с BufferHeight может не работать.
%) Исправлены Ctrl+клавиша.
%) Не двигался курсор в командной строке.
%) Клавиши Ctrl, Shift и Alt 'залипали'.
!) Что-то непонятное с FARHints. Если создано несколько консолей (/multi) - хинт вслывает для всех консолей сразу.
*) Если произошла ошибка запуска приложения (far, cmd, ...) консоль отображается на экране с информацией об ошибке.
?) В каких-то случаях размер схлопывается до минимального?
+) Возможность не посылать в консоль события получения/потери фокуса (чтобы не пропадало окошко быстрого поиска в панелях). Параметр настроек "SkipFocusEvents"=hex:01.
%) Поправлена пересылка в консоль некоторых клавиш (Enter, Esc, Tab, ...).
+) В плагин добавлена экспортируемая функция IsConsoleActive().
%) Исправлен баг падения плагина при использовании Anamorphosis.
+) Добавлен отладочный ключик реестра 'DumpPackets'.
%) Вроде исправлено схлопывание окошка при запуске до минимального размера.
!) Убраны нафиг /SetParent, /SetParent2, /Windows7, /DontSetParent.
*) Sources. Создан новый класс CRealConsole, в который вынесен код из CVirtualConsole. Последний должен отвечать только за графику.
?) Не посылались Ctrl-C/Ctrl-Break.
?) Заглушка для исправления 'непрорисовки' консоли (раз в секунду данные пересылаются в GUI независимо от 'измененности').
?) Win+~ - перестартовывает текущую консоль (у пользователя запрашивается подтверждение).
*) Ключи /conman & /nocoman заменены на /multi & /nomulti.
+) Вернул режим BufferHeight.
+) При запуске консольных программ из FAR автоматически увеличивается размер буфера.
+) Чтобы FarHints не показывал хинты для всех открытых консолей одновременно - в каталоге с плагином временно лежит infis.dll (от конмана там только имя файла).
-) До лучших времен отключена возможность выделения мышкой в режиме BufferHeight.
*) ConEmuC.exe собран без использования VC-шных библиотек.
+) В первой закладке вместо 'Console/Panels' отображается заголовок консольного окна и динамически обновляется.
+) Закладки отображаются для всех консолей разом, позволяя 'прозрачно' переключаться между ними.
+) При наведении мышки на закладку с обрезанным заголовком (…) отображается тултип.
*) Общение с плагином переведено на пайпы.
%) Плагин подвисал при попытке переключения между закладками, если в панелях было активировано верхнее меню.
%) Для всех кнопок тулбара в тултипе отображался заголовок активной консоли.
%) Фокус в закладку больше не попадает, вернул закрытие закладки правой и средней кнопкой мышки.
+) GUI теперь может сам обрабатывать переключение табов (окон) с клавиатуры. Так что теперь переключение между консолями прозрачно для пользователя.
%) Фикс запуска команд.
%) Поправлена работа флажка 'Monospace' (не путать с 'Force monospace'). На некоторых моноширных шрифтах (i.e. 'Fixedsys') буквы под курсором прыгали влево.
%) При смене параметров шрифта/сглаживания в окне настройки экран не обновлялся или портился.

*) Изменен способ передачи содержимого консоли, глюк непрорисовки может исчезнуть.
+) Долгожданный просмотр вывода консольной программы. Пример макроса на CtrlO лежит в папке плагина.
%) После создания новой консоли фокус ввода мог "уходить" из ConEmu.
%) Исправлено несколько глюков ресайза.
*) В режиме с прокруткой полоса прокрутки больше не отображается постоянно и не отъедает место. Она всплывает при наведении мышки. О ее наличии сигнализирует 'нажатая' кнопка 'BufferHeight mode' на панели инструментов.
+) В консоль пересылаются нажатия XBUTTON1 & XBUTTON2 (у меня это наклон колеса мышки влево/вправо). Пример макроса в MouseWheelTilt.reg.

+) Форматирование консольного вывода (пустые строки в начале и конце в редактор/вьювер не попадают).
+) В меню плагина отображается дополнительная команда - открыть консольный вывод во вьювере.
+) При XLat в Far меняется индикатор языка в ConEmu (точнее смотрите параметр MonitorConsoleLang).
%) Продолжаем лечить непрорисовку.
%) ConEmuC падал при запуске команд cmd.
%) Лечим глюки ресайза.

* При изменении размера окна мышкой - консоль опять ресайзится сразу.
* При открытом PictureView левая и верхняя граница окна 'не таскается' мышкой.
* Исправлена реакция на изменение размера буфера из консольного приложения.
* В основной иконке ConEmu добавлен 48x48x256.
* Новая попытка исправить глюк неоткрытия окна настроек.
* Немного подправлено открытие окон каскадом.
* В формате заголовков закладок можно использовать "%i' - номер окна.
??? возможно
* Ускорено отображение изменений в консоли + ConEmu меньше использует процессор.

Maximus5 - 2009.04.24

* Поправлена отрисовка окна во время запуска приложения.
* Попытка исправить глюк неоткрытия окна настроек.
* Правим ошибки ресайза.

Maximus5 - 2009.04.23

* Правим ошибки ресайза.

Maximus5 - 2009.04.22

* В окне настройки добавлена кнопка 'Apply' для применения изменений в группе 'Window size'.
* При открытом PictureView запрещено изменение размера окна.
* После закрытия PictureView передергивался размер консоли -> было мигание.
* После двойного щелчка по заголовку (maximize) в консоль проваливался LButtonUp.
* Изменен 'умолчательный' символ активации плагина.
* Изменен набор примеров макросов в каталоге плагина:
  + AltEnter_Exec.reg  - перенаправить вывод консольной программы в редактор (выполняется содержимое командной строки).
  + AltEnter_Props.reg - отобразить стандартный диалог свойств файла (проводник Windows).

Maximus5 - 2009.04.19

* Временно убрана поддержка ConMan.
* В предыдущей версии отвалилось изменение размера окна.
* Выскакивала ошибка: Can't start 'TabBarClass::Retrieve'. Last operation 'TabBarClass::Retrieve' was not finished!
* При попытке сменить Ansi-aliasing - выскакивал 'Assertion'.
* Оптимизация отрисовки при ресайзе.

Maximus5 - 2009.04.15

* Улучшен внешний вид панели с табами и кнопками ConMan-а.
* При выделении мышкой в режиме BufferHeight выделение 'прыгало'.
* При смене заголовка неактивной консоли ConMan-а мигали табы.
* Если табы отключены - не пытаемся получить информацию о них из плагина.
* Кнопка альтернативной консоли (панель конмана) не включалась при Win-A.
* Драг теперь начинается только при клике в рабочую облась панелей (сервисные области игнорируются).

Maximus5 - 2009.04.12

* Изменен внешний стиль табов (пока просто кнопки).
* В режиме BufferHeight не работало выделение мышкой.
* Попытки поправить неудачные выставления размеров консоли.

Maximus5 - 2009.04.10

* При открытии PictureView отстанавливалась отрисовка всех остальных окон ConEmu.
* Чтение содержимого консоли вынесено в отдельную нить.
* Проблемы с отрисовкой правого и нижнего края окна.

Maximus5 - 2009.04.07

* Поправки в работе с мышью.

Maximus5 - 2009.04.06

* Изменен способ пересылки мышиных событий в консоль.
* В режиме Window size = Normal - окна могут открываться каскадом.

Maximus5 - 2009.04.02

* Бонус :-) можно настроить 'автозапуск' КонЭму при запуске cmd.exe или любого пакетного файла. Запустить один раз 'cmd_autorun.cmd /i'.
* Побеждено мелькание консольного окна при старте программы. В редких случаях, когда запуск идет с ярлыка и не разворачаивая окно на весь экран, чтобы избежать мелькания - укажите в свойствах ярлыка 'Run - Minimized'.
* Оптимизация отрисовки курсора.
* Во время загрузки приложения (i.e. 'far.exe') в заголовке окна отображается строка запуска.
* В консоль больше не пересылается WM_SYSCOMMAND с wParam>=0xF000, ибо консольное окно странно реагирует и часто перехватывает фокус.
* Добавлен параметр '/max' (а для разрабочиков '/debug' & '/debugi').

Maximus5 - 2009.04.01

* Не работал CtrlWinAltSpace при /SetParent.
* Сменилась отрисовка курсора.
* На вкладке 'Info' отображается полная строка запуска ConEmu.

Maximus5 - 2009.03.29

* Небольшие правки в dll-ках ConMan.
* После попытки драга с областей за пределами панелей постоянно выскакивала ошибка "Can't open file mapping" (проблема с таймаутом пока осталась).

Maximus5 - 2009.03.28

* Опция 'Minimize to tray'.

Maximus5 - 2009.03.27

* Копирование/перемещение (при Drop из внешних приложений) выполняется в отдельной нити, т.е. во время копирования больших файлов можно продолжать работу в FAR.

Maximus5 - 2009.03.26

* Разрешен Drag с временной панели. Запрещен Drop на плагиновые панели из внешних приложений.

Maximus5 - 2009.03.25

* При Drag-n-Drop в FAR 1.7x плагин падал.

Maximus5 - 2009.03.24

* При Drop файлов из внешних приложений срабатывал Move вместо Copy.
* После включения флажка 'ConMan', ConEmu не запускался, если отсутсвовали необходимые dll-ки.

Maximus5 - 2009.03.22

* Не срабатывал Drag.
* В диалог настройки добавлен флажок 'ConMan'. Его можно использовать вместо параметра запуска '/ConMan'.

Maximus5 - 2009.03.20

* Плагин вис в FAR 1.7x ('...Waiting for result (10 sec)').
* Лечим падение при драге в Windows Vista.
* Поддержка дропа элементов, не являющихся файлами (например из Outlook). В этом случае доступно только копирование, так что если видите 'запрещающий курсор' - жмите Ctrl.

Maximus5 - 2009.03.19

* Изменения в DragDrop.
  Drag возможен как левой так и правой кнопкой мышки (разрешаются в настройке раздельно).
  При драге, текущее действие отобржается курсором (Copy - курсор с плюсиком, Link - со стрелкой).
  Разрешено создание ярлыков (только когда выделен один файл или одна папка).
  При драге правой кнопкой мышки во ВНЕШНИЕ приложения - всплывает контекстное меню (copy/move/link).
  Для каждой кнопки мышки можно указать клавишу-модификатор (например LeftCtrl), удерживать которую необходимо при клике.
  Флажок 'Copy by default' теперь имеет только два состояния и определяет именно действие по умолчанию (остальные при этом не запрещаются).
  При перетаскивании между панелями (режим Copy/Move) обработка передается в FAR (F5/F6).
  Drop разрешен только при включенном флажке 'Allow Drop', который имеет 3 состояния.
  'Off' - Drop НЕ разрешен из ВНЕШНИХ приложений, между панелями - разрешен;
  'On' - Drop разрешен как из внешних приложений, так и между панелями;
  '3s' - то же, что и 'On', но подтверждения копирования/перемещения между панелями не производится.
  Во время драга можно использовать стандартные модификаторы для принудительного включения режима:
  'Ctrl' - копирование, 'Shift' - перемещение, 'Alt' - создание ярлыка.
  Нажатие 'Esc' - отменяет драг.
* Параметр (PID) для ключа '/Attach' необязателен. При отсутствии PID - пытаемся подхватить текущее консольное окно.
* Не активировалась мышкой вкладка 'Panels'.
* Попытка не менять размер консоли в конмане (только при переключении кнопками).
* В диалоге настройки для некоторых элементов (пока DragDrop) включены всплывающие подсказки. Есть желание написать подсказки к другим элементам - Welcome :)
* Ошибки разбора командной строки.

Maximus5 - 2009.03.11

* Попытка исправить глюк с неработающим CtrlWinAltSpace.
* Перед началом Drag'n'Drop или после его окончания выделение могло перескакивать на другой файл(папку).
* Исправлена 100% загрузка в свернутом состоянии.
* Поправил табы - в некоторых случаях могли не обновляться после смены списка окон.

Maximus5 - 2009.03.10

* Исправлен глюк с горизонтальным курсором при наличии фоновой картинки.
* На время работы 16бит. приложения для ConEmu устанавливается высокий приоритет.
* Не работала панель с кнопками конмана.

Maximus5 - 2009.03.09

* Для кнопок конмана отображаются всплывающие подсказки.
* Функции FAR API теперь выполняются в основном потоке, активация плагина через макрос F14 (создается автоматически).
! Изменен способ передачи информации о закладках (возможны глюки).
* Курсор теперь отрисовывается немного по другому, мусора от курсора вроде быть не должно.
* Возможность явного указания процессоров, на которых выполняется ConEmu ("AffinityMask").
* При запуске 16битного приложения размер окна не изменяется, а консоль (80x25) отрисовывается в центре. Передключаться конманом до выхода из 16бит приложения не рекомендуется.
* Продолжение BufferHeight. Автоматическое включение прокрутки при увеличении буфера консольным приложением.

Maximus5 - 2009.02.26

* Плагин валился при драге в FAR 2.0 build 789+.
* Для запуска ConMan рекомендуется использовать версию 2.34.4 и ключик /ConMan (вместо ConMan.exe).
* При наличии табов и ключика /ConMan появляется панель с кнопками для управления конманом.
* Вроде починил глюк отображения символа под курсором.

Maximus5 - 2009.02.26

* Изменены счетчики производительности (вкладка 'Info' окна настроек). Отображаются в миллисекундах.

Maximus5 - 2009.02.25

* Корректный Drag'n'Drop и обновление табов при смене консолей КонМана.
* В окно настроек добавлена вкладка 'Info', на которую переехали Render times и добавлена информация о консольных процессах.

Maximus5 - 2009.02.24

* Поддержка изменений API FAR2 build 789 (плагин работает в FAR2 build 757 и выше или FAR 1.7x build 2470 и выше).
* В Windows Vista и выше по умолчанию были недоступны некоторые юникодные символы (например троеточие '…', иероглифы, и др.), т.к. для реальной консоли не устанавливался TTF шрифт.
* Расширение визуализатора не работало в конмане.

Maximus5 - 2009.02.23

* При выходе из окна настроек (при включенных табах) ранее открытые табы пропадали.
* 'Background image' теперь отображается и при включенном 'Force monospace'.
* Чуть поправил закрытие окна и завершение плагина. Вроде бы проблем с ExitFAR(W) больше быть не должно.
* Потихоньку совершенствуем поддержку пропорциональных шрифтов.
* В плагин добавлена информация о версии.
* В меню добавлен пункт 'Dump...' для сохранения текущего содержимого консоли в файл.

Maximus5 - 2009.02.21

* Изменения в ресайзе окна, корректировка начального положения.
* Отображение непечатных символов в редакторе (Tab,Eol,Eof). Настраивается на закладке цветов. Необходим плагин Visualizer! Отображаемые на их месте символы можно настроить (см. Settings-ConEmu.reg).
* Расширенные цвета консоли (16..31) не сохранялись в реестр.

Maximus5 - 2009.02.20

* Диалог настроек разбит на две вкладки.
* Для тех, кому не хватает 16 цветов консоли, добавлена возможность использовать 32 цвета текста ;) за счет игнорирования одного из выбираемых цветов фона.
* Настройки цветов теперь сохраняются в ключе ConEmu, ключ консоли не трогается. Умолчания для цветов (в новой конфигурации) по прежнему берутся из свойств консоли.
* Изменения в ресайзе окна...

Maximus5 - 2009.02.18

* Размер окна FullScreen/Maximized/Normal теперь устанавливается другим способом.
* В плагине изменен способ поиска окна ConEmu (переменная среды больше не используется из-за КонМана, хотя и устанавливается).

Maximus5 - 2009.02.17

* Добавлен параметр '/Attach <PID>'. При его указании ConEmu не запускает новый процесс, а пытается подключиться (внедриться) к уже существующему консольному приложению, указываемому через код процесса (<PID>).
* При отключении FARа от консоли (Ctrl-Alt-Tab) плагин предлагает запустить новый экземпляр ConEmu, который 'подхватит' новую консоль FARа (переключалка по табам при этом к сожалению отключается).

Maximus5 - 2009.02.16

* Изменен способ разворачивания окна в FullScreen. Проблем с расширениями, внедряющимися в рамку окон (типа FileBox eXtender) больше не будет.

Maximus5 - 2009.02.15

* Изменена обработка WM_SETFOCUS:
?) Не должно быть проблем с активацией диалога настроек в Vista.
?) Наверное Win+R больше не будет появляться под ConEmu.
?) Возможно (хотя и не должны), могут появиться другие глюки, например клавиши не будут проходить в FAR.
* Поправленный reg-файл.
* Переделано общение с плагином при Drag'n'Drop. Раньше ConEmu мог подвисать.
* Теперь 'Таб' пытается закрыться и по щелчку правой кнопкой мышки (на тачпадах средней кнопки нет вообще).
* Исправлена ошибка сохранения положения минимизированного окна.
* Макрос для 'табов' создается автоматически, после подтверждения пользователем.
* В плагине вернулись lng-файлы - подверждение для создания макроса.
? Может быть перестанет валиться при выходе, если присутствует PowerShellFar.
? Ready to ConMan & FarHints.

Maximus5 - 2009.02.13

* В ConMan внесены необходимые изменения (2.34.1) для его использования без ключика '/SetParent'.
* Если обновлять ConMan не хотите - можно использовать ключик '/SetParent2' (но тогда отвалится FarHints).
* Вроде бы решена проблема непереключения раскладки при отсутсвии ConIme.
* Если в окошке предупреждения о 'LoadConIme' нажать кнопку 'Cancel' - оно больше не появится (надеюсь).
* Изменилось (вернулось) имя класса главного окна ConEmu.
* Соответственно, обновился враппер PictureView.
* Создается переменная среды 'ConEmuArgs', содержащая аргументы запуска ConEmu.
* Флажок 'Always update con.handle' включается автоматически, если в строке запуска есть conman.exe.
? Теоретически, можно организовать табы и для консолей ConMan... Высказываемся ;-)

Maximus5 - 2009.02.11

* При нажатии Alt+кнопка раздавался писк.
* Врапперу PictureView опять не нужен ConEmu.dll.
* Табы теперь отображаются с рамкой. Если хотите как раньше - только заголовки:
  [HKEY_CURRENT_USER\Software\ConEmu]
  "TabFrame"=hex:00

Maximus5 - 2009.02.10

* SlideShow для PictureView мог не работать (особенно в FullScreen).
* Новый враппер для PictureView.
* В трее отображается та же иконка, что и в главном окне.
* В заголовке диалога 'About' отображается версия ConEmu.
* Если PictureView работает в режиме Ctrl-Q - не отрисовывалась видимая часть консоли.

Maximus5 - 2009.02.08

* Лечим глюки в отображении фона (картинок). Утечки, стек, проблемы с меньшими чем экран изображениями, с шириной некратной 4, некорректные дескрипторы и прочие прелести (и как это работало?).
* Иконка в окне диалога настроек.
* Автоскрытие табов при третьем положении флажка.

Maximus5 - 2009.02.07

* Отрисовка теперь идет в дочернем окне ConEmu (возможны глюки).
* Изменена логика ресайза окна.
* Возможность центрирования содержимого окна в полноэкранном и развернутом режимах.
  [HKEY_CURRENT_USER\Software\ConEmu]
  "TryToCenter"=hex:01
* 'Интеллектуальное' появление/исчезновение табов.
* При использовании BufferHeight после запуска FAR отключается режим консоли 'QuickEdit' при выходе из FAR - возвращается обратно.
! Практически все функции разнесены по классам, многие события вынесены в отдельные методы.

Maximus5 - 2009.02.05

* Попытка запустить не работающий 'Force monospace'. Буковки в этом режиме теперь центрируются.
* Добавлена возможность принудительной установки ширины букв в этом режиме (в Arial, например, ширина по умолчанию получается очень большой).
* Потихоньку пишем 'FAQ-ConEmu.txt'. Есть что добавить - присылайте.
* Можно было открыть несколько диалогов настроек.

Maximus5 - 2009.02.03

* Кнопки 'OK' в настройке плагина больше нет. Кнопка 'Save settings' после сохранения закрывает окно настроек.

Maximus5 - 2009.02.03

* Плагин: Оптимизация выделения памяти и пересылки информации о табах.
* Плагин собирается в GCC.

Maximus5 - 2009.02.02

* В заголовке окна настроек отображается имя конфигурации (если при запуске ConEmu был указан ключ /Config).
* Минимальный размер окна консоли - 28x9.
* [DEBUG сборка] консоль отрисовывается в дочернем окне. сильно моргает. с чего бы это?

Maximus5 - 2009.02.01

* Глючил размер буфера консоли, если в свойствах ярлыка было указано 'Maximized'.
* Ключик /fontfile - загрузка шрифта из файла (by Mors).
* Поддержка Windows XP themes.
* Добавлен примерный файл настроек реестра Settings-ConEmu.reg.
* Форматирование заголовков табов. Умолчания можно изменить в реестре (см. TabPanels, TabEditor,...).
* Исправлена утечка памяти в юникодной части плагина.

Maximus5 - 2009.01.30

* Поддержка изменений API FAR2 build 757 (плагин работает в FAR2 build 748 и выше или FAR 1.7x build 2470 и выше).
* Оптимизация вызовов FAR API. Не освобождалась память, выделенная функциями API.
* Третье состояние флажка 'Enable Tabs' - закладки появляются при открытии редактора/вьювера. Если включен - закладки отображаются всегда.

Maximus5 - 2009.01.27

! Попытка интегрировать Drag с ФАРовским копированием пока не удалась - глючит и повисает.
* Расширенное сообщение об ошибке, если не удалось запустить процесс (far, cmd, /cmd).
* Починил Drag'n'Drop в ConMan.

Maximus5 - 2009.01.26

* Если рядом с ConEmu.exe лежит одноименная иконка - грузится именно она.
  Если файла иконки нет - загружаем встроенную в ConEmu, номер иконки (1,2,3) можно указать в реестре. Пример:
  [HKEY_CURRENT_USER\Software\ConEmu]
  "IconID"=dword:00000003
* При бросании файла в корень диска (Vista) возникала ошибка.
* При Drag'n'Drop между панелями внутри одного FAR'а открывается встроенный диалог копирования/перемещения (Ctrl пока не учитывается).
* Флажок 'RightClick for context menu' имеет три состояния.
  (Отключен) - все нажатия правой кнопки мышки пересылаются в FAR без изменений;
  (Включен) - если курсор не двигался, то при отпускании правой кнопки отображается контекстное меню (на кнопке Apps должен быть соотвествующий макрос); если курсор двигался - пересылаются в FAR без изменений;
  (3 состояние) - меню отображается если кнопка мышки удерживалась более 0.3 сек. а курсор не двигался, иначе - пересылаются в FAR без изменений.


Maximus5 - 2009.01.25

* Пока автор плагина FarHints не научит его работать с новым ConEmu - версию для FAR2 можно использовать через Wrapper.
* Не отображался Help для плагина PictureView.

Maximus5 - 2009.01.24

* Установка родителя по умолчанию более не делается. Плагин PictureView использовать через Wrapper.
* В некоторых случаях в консоли появлялась горизонтальная прокурутка, проводящая к глюкам отображения.
* После изменения размеров окна ConEmu с открытым PictureView размер консоли и самой картинки не менялся.
* При листании картинок в PictureView на экране могли появляться глюки.
* Добавлен режим SlideShow для PictureView. Включается кнопкой Pause. Задержку можно увеличивать/уменьшать кнопками -/= (между '0' и BackSpace на основной клавиатуре). Отключется режим нажатием любой другой кнопки, или Pause.
  Задержка задается в реестре в миллисекундах, пример:
  [HKEY_CURRENT_USER\Software\ConEmu]
  "SlideShowElapse"=dword:00001000

Maximus5 - 2009.01.23

* Неизвестно почему - отвалилась установка шрифта в консоли. По какой-то причине OpenProcess в setconsoleinfo.cpp возвращал NULL (если кто хочет - поковыряйтесь). Если сие так - используем (-1)
* Вернулась версия для FAR Ansi. Плагин conemu.dll может использоваться как в FAR 1.71 build 2470 (и выше), так и в FAR 2.0 build 748 (и выше).
* Вроде починил изменение размера окна при появлении табов.
* Табы не работали, если не устанавливался родитель для окна консоли.
* Могли падать при включенных табах если полный путь к файлу в редакторе был длинным.
* Если случилось несчастье и ConEmu упал - отображается соответствующее сообщение и (после OK) процесс FAR.exe прибивается (раньше оставался висеть), консоли все-равно уже нету.
* Для запускаемого из-под ConEmu процесса устанавливается переменная окружения ConEmuHWND (пример: ConEmuHWND=0x000b0a9c). Может кому понадобится...

! Вроде бы курсор во Viewer мигает при появлении табов?
! Глюки с буферами, сдвигами экрана, черным фоном под частично прорисованными панелями и т.п лезут если консоль физически не влезает в экран. Чтобы этого не было - выберите шрифт поменьше через меню 'Console properties'

Maximus5 - 2009.01.21

* Иногда после Shell'овского drop на пассивную панель отрабатывал drop в самом FAR (хотя может и не до конца вылечилось?)
* Shell'овский drop мог отрабатывать два и более раз подряд
* Убран двойной слеш при перетаскивании с корня диска
* Плагин мог валиться, если путь перетаскиваемого превышал MAX_PATH, или текущий путь превышал MAX_PATH при бросании (ежели такое может быть в FAR'е)
! К сожалению, FCTL_GETPANELSHORTINFO не заполняет lpwszCurDir
* Флажок 'Copy by default' теперь имеет три состояние.
  Если выключен - элемент ВСЕГДА перемещается, в том числе и в другие приложения.
  Если включен - ВСЕГДА копируется, в том числе и в другие приложения.
  При третьем состоянии - копируется при Drop в панель FAR, а при Drop в другое приложения - определяется приложением-приемником (для проводника это копированием между дисками и перемещение в пределах одного диска).
  Для облегчения понимания действий в предыдущих строках не упоминается модификатор - нажимая Ctrl можно переключать действие как при Drag (если только флажок не в третьем состоянии) так и при Drop.
* Добавлены ключики /SetParent и /DontSetParent (aka /Windows7). В Windows7 и выше по умолчанию родитель консольного окна не меняется, отрицательное значение /BufferHeight более не влияет. Установка родителя требуется для некоторых плагинов: PictureView, Conman, ...

Maximus5 - 2009.01.20

* Убраны задержки при таскании диалогов
* Всплывающее меню теперь всплывает при задержке и отпускании правой кнопки, и его можно убрать клавишей Esc
* При включенном 'RightClick for context menu' теперь можно выделять файлы двигая мышкой с зажатой правой кнопкой
* При попытке выделить блок через Alt+Ins - включался Drag'n'Drop
* WM_MOUSEMOVE беспрерывно посылался в консоль, даже если курсор мышки не двигался (хм? может так и надо было?)
* ConEmu рушился, если длина заголовка консоли превышала MAX_PATH символов
* Убрана ошибка изменения размера окна после появления 'табов'

Maximus5 - 2009.01.19

* Уменьшен по высоте диалог настроек
* Добавлен пункт меню 'Console properties'
* Добавлена обработка параметра /BufferHeight (сборка NightRoman)






alex_itd - 2009.01.18

* вроде поправил глюк с AltEnter
* частично переписал общение с плагином через пайпы
* детект закрытия фара как советовал DrKnS (проверяйте Updater)
* отключил XP темы у прогресс баров (темами не пользуюсь, проверить не могу) (чуть попозже сделаю подстройку цвета под палитру)
	
* Drag'n'Drop теперь работает только на файловых панелях 
* крыжик в настройках Drag'n'Drop 'Copy by default'
* фикс переключения раскладки от Maximus5 
* фикс мелких шрифтов от NightRoman
	  


= 2009.01.18 === (NightRoman changelog below) ===

*) Решена проблема отрисовки больших окон с мелкими шрифтами, иными словами
большого буфера данных, на котором функции ReadConsoleOutput*() не работают.
Идея построчного чтения буфера заимствована из FAR исходников, но этот режим
включаем только при сбоях, а не при превышении фиксированного лимита, как там.

*) Добавлены конфигурации, что позволяет иметь разные наборы настроек для
разных программ или тех же программ, но в разных окнах. Конфигурация задается
только в командной строке параметром /Config ConfigName, в реестре создается
подключ ConEmu\ConfigName, где и хранятся индивидуальные настройки. Пример:

 ConEmu /Config ScrollMode /BufferHeight 9999 /Cmd PowerShell.exe

использует существующую (или создает новую, если будет сохранение опций)
конфигурацию 'ScrollMode'. Там в диалоге настроек заточим окно под вкусы
консоли с прокрукой, а не Фара: настройки порой хочется иметь разные.

*) Добавлен файл About-ConEmu.txt - микро хелп с официальной и технической
информацией, а то техническая нигде толком и не упомянута кроме форума.

*) В прошлой неупомянутой тут версии для режима с высотой буфера устранены
скачки выделения мышью. Это сделано вычурно, но работает, и другие пути не
найдены - невидимое настоящее окно консоли динамически двигается вместе с мышью
так, чтобы относительные координаты мыши в нем соответствовали текущим в
видимой виртуальной консоли - так удается перехитрить неизвестно что, но от
чего выделение могло прыгать.


= Experimental BufferHeight and some fixes 2008.07.03 =

ЗАПУСК С УСТАНОВКОЙ ВЫСОТЫ БУФЕРА КОНСОЛИ (РЕЖИМ ПРОКРУТКИ)

Дополнительный ключ: /BufferHeight <высота буфера>. Примеры:
conemu /BufferHeight 9999 /cmd cmd.exe
conemu /bufferheight 1000 /cmd powershell.exe -noexit myscript.ps1

Если команда /cmd не задана, берется сохраненная команда из реестра, если есть,
а если нет, то в режиме прокрутки запускается 'cmd', а в стандартном режиме
сначала пытаемся запустить 'far', потом 'cmd'.

Проверка на слишком маленькую или слишком большую заданную высоту буфера не
делается, рекомендуется выбирать ее так, что она заведомо больше высоты окна (в
строках), но не больше 9999, что является магическим ограничением высоты буфера
в виндовом диалоге настроек консоли.

Режим прокрутки предназначен в первую очередь для интерактивных сессий в
оболочках типа Cmd или PowerShell и не предназначен для программ типа FAR.
FAR, как и раньше следует запускать без всяких /BufferHeight - при этом
установка родителя окна консоли ДЕЛАЕТСЯ, то есть плагины, которые этого
ожидают, это и получают.

ПРИМЕЧАНИЕ: если величина /BufferHeight отрицательная, то это является
указанием принудительно установить родителя консольного окна. Это может быть
нужно, например, для нормальной работы приложений или плагинов FAR, которые
ожидают, что у консоли родительское окно - это окно ConEmu. В таком режиме в
процессе выделения мышью выделение может скакнуть в левый верхний угол - как
бороться - пока неясно, но если продолжать выделение, оно 'восстанавливается'.
Фиксится это пока не будет, ибо по нормальному приложения должны находить окно
ConEmu более универсальным способом (от hoopoe, см. форум по ConEmu).

ОПИСАНИЕ РЕЖИМА ПРОКРУТКИ

*) Окно имеет стандартную вертикальную полосу прокрутки.
*) Управление прокруткой с клавиатуры:
- CtrlPgUp, CtrlPgDn листают страницы вверх-вниз
- CtrlUp, CtrlDn прокручивают вверх-вниз построчно
*) Работа с выделением только мышью: выделение - левой кнопкой с перемещением,
копирование и вставка - правой кнопкой.

ПРОЧИЕ ИЗМЕНЕНИЯ

*) Исправлен мелкий дефект в отрисовке курсора: он мог ошибочно оставаться
отрисованным в поле ввода после перехода с поля ввода на кнопку или другой
элемент диалога, при активации которого курсор должен скрываться.

ТЕХНИЧЕСКИЕ ПОДРОБНОСТИ

*) Реализована отрисовка выделения (работает только в режиме прокрутки).
*) В режиме прокрутки положение окна консоли подгоняется под положение мыши -
это нужно для корректной работы выделения в оригинальной консоли.
*) В режиме прокрутки при старте устанавливаем QuickEdit режим, это нужно для
возможности выделения мышью в оригинальной консоли.
*) Установка параметров окна консоли в буфер режиме (предложено hoopoe): при
первом вызове устанавливаем высоту буфера /BufferHeight, при последующих смотрим
на наличие вертикальной прокрутки: если есть, то сохраняем текущую высоту буфера
(она может быть уже и не равна /BufferHeight), иначе подгоняем под высоту окна.
*) WM_MOUSEWHEEL теперь обрабатывается как событие мыши, нужно для прокрутки.
*) WM_RBUTTONUP НЕ обрабатывается (как и было раньше), чтобы избежать
нежелательного появления консольного меню в некоторых ситуациях. Добавлен
комментарий в коде.
*) WM_RBUTTONDBLCLK преобразовывается в WM_RBUTTONDOWN (как и было раньше). По
задумке Zoin это помогает быстро быделить и тут же развыделить элемент панели
Фара двойным правым кликом (не знаю зачем, но считаем, что автору видней).
Добавлен комментарий в коде.



= Version 2008.03.26 =

ПОНЕНЦИАЛЬНАЯ ПРОБЛЕМА ПЕРВОЙ ОТРИСОВКИ

При размерах окна равных дефолтным размерам консоли теоретически была возможна
неправильная первая отрисовка некоторых случайных символов (баг оптимизации).
Исправлено.

ИЗМЕНЕНИЯ В ЛОГИКЕ ОТРИСОВКИ КУРСОРА

При потере фокуса окна курсор оставался видимым или невидимым в зависимости от
его текущего состояния. Стандартное же поведение для неактивного окна - гасить
курсор. Сделано по стандартному.

Символ под курсором и некоторые идущие за ним иногда рисовались даже если это не
нужно; исправлено. Прирост скорости небольшой, но все ж так лучше.

ИСПРАВЛЕНА НАСТРОЙКА ШРИФТА BOLD

Настройка сохранялась, но считывалась неверно - исправлено.

ТЕХИНФО: АЛЬТЕРНАТИВНЫЙ ШРИФТ РАМОК

[HKEY_CURRENT_USER\Software\ConEmu]
"FontName2"="Courier New"
"FontSizeX2"=hex:0b,00,00,00

FontName2 задает альтернативный шрифт рамок, 'Lucida Console' по умолчанию.
Однако, при основном шрифте, например, 'Consolas' спец. символы оказываются
шире, чем надо, и тогда 'Courier New' выглядит неплохой заменой.

В зависимости от разных параметров одного указания шрифта рамок может быть
недостаточно, и для точной настройки надо еще подогнать его ширину, то есть
параметр FontSizeX2. Демо: основной шрифт 'Consolas' 16 x 10, тогда для
рамочного 'Courier New' его ширина почему-то должна быть 11 (0xB).

ПРОЧИЕ КОСМЕТИЧЕСКИЕ ИЗМЕНЕНИЯ

Меню: текст &Settings заменен на S&ettings, чтобы избежать конфликта с хоткеем
пункта &Size в режиме обычного окна.

Слегка упрощена отрисовка с фоновой картинкой, когда происходит только
перемещение курсора, в комстроке, например.

Кое-где устранены лишние вспомогательные вызовы установки размера буфера консоли
(по-моему, лишние, но если у Zoin были на это виды - решать ему).



= Version 2008.02.23 =

ИЗМЕНЕНА ЛОГИКА ЗАПУСКА ПРИЛОЖЕНИЯ

Было так: если команда пустая, то сначала запускается она, и в случае сбоя (а он
всегда) запускается Far или Cmd. Итого всегда лишняя попытка запустить пустую
команду. Если команда не пустая, но не запускается, то вместо сообщения о сбое
запускается Far или Cmd; это и нелогично, и может создать иллюзию, что команда
отработала, например, если конечной целью и был запуск Фара, но сначала должно
было выполниться что-то еще, что не отработало. Предлагается так: если команда
пуста, то запускаем Far или Cmd, если не пуста - запускаем ее, а в случае сбоя -
сообщаем об ошибке и выходим.

ТЕХИНФО: АЛЬТЕРНАТИВНЫЙ ШРИФТ ДЛЯ ИСПРАВЛЕНИЯ РАМОК

[HKEY_CURRENT_USER\Software\ConEmu]
"FontName2"="courier new"

Задает альтернативный шрифт для исправления рамок; по умолчанию используется
шрифт 'lucida console', который неплох для самих рамок, но жирноват для прочих
специальных символов, отчего они слегка наезжают на соседей по ширине. 'courier
new' выглядит неплохой заменой, например, если основной шрифт 'consolas'.



= Version 2008.02.21 =

УВЕЛИЧЕНА СКОРОСТЬ ОТРИСОВКИ

В VirtualConsole::Update не перерисовываем символы, которые не изменились,
при этом делаем не только глобальную проверку в самом начале, но проверяем
каждый символ и атрибуты в самом процессе в цикле по строке. Это позволяет
избежать изрядного числа перерисовок. Особо проверяем и перерисовываем
символ под старой позицией курсора. Однако, если уже начали рисовать, то
рисуем максимум подходящих символов включая и неизменные (проверено, так
быстрее, чем несколько раз отрисовывать разрозненные цепочки).

Render time (округлено на глазок, в худшую для новой версии сторону):
*) В панелях старый вариант - 1000000 на любой операции, новый вариант -
набор в ком. строке - 2300, навигация вверх-вниз по файлам без прокрутки -
2500, с прокруткой - 150000.
*) В редакторе старый вариант - 850000 при любой операции, в новой версии -
перемещение без прокрутки - обычно не более 3000, с прокруткой зависит от
длины строк, ширины экрана и расцветки, на типичном файле с исходным кодом с
не очень длинными строками и с колорером ускорение в 3-4 раза.
*) Оптимизирована и форсированная перерисовка (весь экран, например, при
смене опций в диалоге), но разница в производительности не так заметна,
конечно.

Еще устранены несколько вероятно лишних перерисовок при запуске (один вызов,
когда окно еще не окончательное и один или два лишних прохода из-за курсора)

ИСПРАВЛЕН СИМВОЛ ПОД КУРСОРОМ В РЕЖИМЕ РАМОК

Наблюдался нежелательный эффект - символ под курсором в режиме исправления
рамок иногда рисовался юникодным фонтом (видимо, последним выбранным до
этого для рамок). Исправлено.



= Author =

Roman Kuzmin (aka NightRoman)
http://code.google.com/p/farnet/
PowerShell and .NET in FAR Manager
